---
name: Git Workflow
description: Always create a PR when pushing changes
alwaysApply: true
---

# Git Workflow

## Pull Request Requirement

**Always create a Pull Request (PR) when pushing changes to a branch.**

Never push directly to `main` or `master` branch. All changes must go through a PR for code review.

### Workflow Steps

1. **Always create a feature branch** from main before making any changes:

   ```bash
   git checkout main
   git pull origin main
   git checkout -b feature/your-feature-name
   ```

   **Important:** Never work directly on main/master. Always create a branch first, even for small fixes.

2. **Make your changes** and commit:

   ```bash
   git add .
   git commit -m "feat: your descriptive commit message"
   ```

3. **Push to remote**:

   ```bash
   git push origin HEAD
   ```

4. **Create a Pull Request**:
   - Use GitHub/GitLab web interface to create PR
   - Or use GitHub CLI: `gh pr create`
   - Include a descriptive title and description
   - Link any related issues

5. **After PR is merged**:
   ```bash
   git checkout main
   git pull origin main
   git branch -d feature/your-feature-name  # Delete local branch
   git push origin --delete feature/your-feature-name  # Delete remote branch
   ```

### Commit Message Format

Use conventional commit format:

- `feat:` - New feature
- `fix:` - Bug fix
- `docs:` - Documentation changes
- `style:` - Code style changes (formatting, etc.)
- `refactor:` - Code refactoring
- `test:` - Adding or updating tests
- `chore:` - Maintenance tasks

**Example:**

```
fix: add Tailwind color definitions to make buttons visible

- Add primary color palette (50-900) to globals.css theme
- Add gray color palette for secondary buttons
- Remove unnecessary inline styles from Button component
```

### Stash Management

**Never leave changes in stash when pushing code.**

- Always ensure the working tree is clean before pushing/creating PRs
- If stashing is needed, **ask the user first** before using `git stash`
- After completing a task, verify no stashes remain: `git stash list`
- If stashes exist, either apply and commit them, or ask the user how to handle them
- Do not leave uncommitted changes or stashes when finishing a task

### Pre-Push Validation

**ALWAYS run lint and typecheck before pushing code for PR.**

Before pushing any code, you MUST:

1. **Run lint checks** for the affected files/apps:
   ```bash
   # For web app
   cd apps/web && npm run lint
   
   # For API app
   cd apps/api && npm run lint
   
   # Or run for specific files
   npm run lint -- path/to/files
   ```

2. **Run TypeScript typecheck**:
   ```bash
   # For web app
   npx tsc --noEmit --project apps/web/tsconfig.json
   
   # For API app
   npx tsc --noEmit --project apps/api/tsconfig.json
   ```

3. **Fix all errors** before pushing:
   - Lint errors must be fixed (warnings are acceptable but should be addressed if possible)
   - TypeScript errors must be fixed
   - Do NOT push code with lint or typecheck errors

4. **Verify tests pass** (if applicable):
   ```bash
   npm test
   ```

**Important:** If lint or typecheck errors are found, fix them immediately and commit the fixes before pushing.

### When Assisting with Git Operations

When the user asks to commit and push changes:

1. Create a feature branch (never commit directly to main)
2. Stage only the relevant files
3. **Run lint and typecheck** - fix any errors found
4. Create a descriptive commit message using conventional commits
5. Push to the feature branch
6. **Create a PR** using GitHub CLI or remind user to create one
7. Do NOT merge directly to main/master
8. **Verify no stashes remain** before completing the task
